# NetSuite Custom Scripts: UserEventScript and Suitelet

This repository contains two NetSuite custom scripts that work together to generate and display a PDF document for a specific transaction record using a custom HTML template.

## Overview

### Script 1: UserEventScript
This script is a `UserEventScript` that adds a custom button to a specific record's form when the record is viewed. The button, when clicked, triggers the `Suitelet` script to generate a PDF document. The information for this PDF is pulled from the record being worked on, and the template is in the Advanced HTML/PDF section.

### Script 2: Suitelet
The `Suitelet` script is responsible for generating the PDF document for the selected transaction record using a custom HTML template. Once generated, the PDF is displayed in a new browser window.

## Script Details

### UserEventScript

- **File Name:** `UserEventScript.js`
- **Type:** `UserEventScript`
- **Trigger:** Runs before a record is loaded in the view mode.
- **Primary Function:**
  - Adds a custom button labeled `Commercial Inv` to the record's form.
  - The button opens a new window, calling the Suitelet script to generate and display a PDF document for the transaction.

- **Key Parameters:**
  - `custscript_ue_script_id_1`: Script ID of the Suitelet.
  - `custscript_ue_deployment_id_1`: Deployment ID of the Suitelet.
  - `custscript_ue_cust_form_1`: Custom form ID (optional).

### Suitelet

- **File Name:** `Suitelet.js`
- **Type:** `Suitelet`
- **Trigger:** Runs when the Suitelet is accessed via the URL generated by the `UserEventScript`.
- **Primary Function:**
  - Generates a PDF document for the transaction record using a custom HTML template.
  - The generated PDF is displayed inline in a new browser window.

- **Key Parameters:**
  - `custscript_sl_template_id_1`: Gets the ID of the custom HTML template used for generating the PDF.

## How It Works

1. **UserEventScript Execution:**
   - The `UserEventScript` is triggered when a transaction record (e.g., `Item Fulfillment`) is viewed.
   - It adds a button labeled `Commercial Inv` to the form.
   - When clicked, this button calls the Suitelet script, passing the transaction ID.

2. **Suitelet Execution:**
   - The Suitelet script receives the transaction ID from the URL parameters.
   - It generates a PDF for the transaction using the specified HTML template.
   - The generated PDF is named with a combination of the document type and the transaction number (e.g., `Commercial Inv_12345.pdf`).
   - The PDF is downloaded through a new window for the user.

## Usage

Deploy the `UserEventScript` and `Suitelet` scripts in your NetSuite account.

To set up the scripts, the following parameters need to be set and records created.

First, you should create your Advanced PDF Template. 
Once done, create a copy of the transaction form that the PDF will be pulling its information from i.e. Sales Order, Packing Slip or Invoice.
On this copy, ensure that you select the PDF Template you want to use as the default Print Template.
![image](https://github.com/user-attachments/assets/d4a40a18-64c4-415a-8b3f-bacd1aca7502)

Optionally but recommended, make the record inactive so it doesn't appear as an option to use for your users.
Once saved, keep a record of the internal id.
![image](https://github.com/user-attachments/assets/7c331671-590c-4b88-82ee-489bcef14c88)

Back to the scripts, you want to set up the Print Function before the Print Button.
On the deployment parameter for the Function Script, set the Template ID to the one you just saved of the Transaction Form.
![image](https://github.com/user-attachments/assets/700688ba-91d4-47e9-b2aa-c2fa52e3ad12)

On the button script deployment, set the parameters as follows:
Custom Form_# should again be the internal id of the transaction form.
Deployment ID_# should be the id of the print functions deployment.
SL ID_# should be the id of the print function scipt itself.

![image](https://github.com/user-attachments/assets/37e7dc22-f948-4b74-ac52-0bc12a49756d)
![image](https://github.com/user-attachments/assets/80c2eb64-9f97-489d-8d3c-2ab7d1fccd58)

Here are the script records and what they look like for reference.
![image](https://github.com/user-attachments/assets/a204a0fd-8514-47f3-bc8e-6b4012a1954d)
![image](https://github.com/user-attachments/assets/516a68da-d78e-4320-af37-c60f8084af77)

## Contributions

Please feel free to submit issues or pull requests if you encounter bugs or have improvements for these scripts. Contributions are welcome!

## Please don't use my work without giving credit. :(

